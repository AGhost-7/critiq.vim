
Before:
  runtime autoload/critiq.vim
  let g:critiq_github_url = 'http://localhost:5000'
  let g:last_response = {}
  fu! s:on_response(response)
    let g:last_response = a:response
  endfu

Execute(Parses http urls):
  let lines = [
    \ 'origin	https://github.com/AGhost-7/critiq.vim.git (fetch)',
    \ 'origin	https://github.com/AGhost-7/critiq.vim.git (push)',
    \ ]
  AssertEqual
    \ 'AGhost-7/critiq.vim',
    \ critiq#github#parse_url(lines)

Execute(Parse ssh urls):
  let lines = [
    \ 'origin	git@github.com:AGhost-7/critiq.vim.git (fetch)',
    \ 'origin	git@github.com:AGhost-7/critiq.vim.git (push)',
    \ ]
  AssertEqual
    \ 'AGhost-7/critiq.vim',
    \ critiq#github#parse_url(lines)

Execute(lists open prs):
  call critiq#github#list_open_prs(function('s:on_response'))
  call critiq#request#await_response()

  AssertEqual empty(g:last_response), 0

Execute(fetches a diff):
  let g:prs = g:last_response['body']
  call critiq#github#diff(g:prs[0])
  call critiq#request#await_response()

  AssertEqual 'hello diff', g:last_response['body']
